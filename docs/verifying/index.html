

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Verifying - WireMock</title>







<meta name="description" content="Verifying whether specific HTTP requests were made.">

<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="WireMock">
<meta property="og:title" content="Verifying">




  <meta property="og:description" content="Verifying whether specific HTTP requests were made.">





  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2018-11-29T23:14:56-08:00">
  
  
    <link rel="prev" href="/docs/stubbing/" title="Stubbing">
  





  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Tom Akehurst",
      "url" : null,
      "sameAs" : null
    }
  </script>






<!-- end SEO -->





  <!-- Google Analytics -->
<style>.async-hide { opacity: 0 !important} </style>
<script>(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;
  h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};
  (a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
})(window,document.documentElement,'async-hide','dataLayer',4000,
  {'GTM-WQTGSSM':true});</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36386229-2', 'auto');
  ga('require', 'GTM-WQTGSSM');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->




<link href="/wiremock/feed.xml" type="application/atom+xml" rel="alternate" title="WireMock Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<link href="https://fonts.googleapis.com/css?family=Lato|Source+Code+Pro|Cairo" rel="stylesheet">

<!-- For all browsers -->
<link rel="stylesheet" href="/wiremock/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<link rel="shortcut icon" type="image/x-icon" href="/wiremock/images/favicon3.png">

    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg">
            <a href="/wiremock/"><img src="/wiremock/images/wiremock-concept-icon-01.png" style="width: 80px; height: 37px" /></a>
          </li>
          
            

            
            <li class="masthead__menu-item"><a href="/wiremock/docs/" title="Docs">Docs</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="/wiremock/about/" title="About">About</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="https://github.com/tomakehurst/wiremock" title="GitHub" target="_blank">GitHub</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="https://groups.google.com/forum/#!forum/wiremock-user" title="Mailing List" target="_blank">Mailing List</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="/wiremock/external-resources/" title="External Resources">External Resources</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="http://consulting.wiremock.org" title="Pro Support">Pro Support</a></li>
            

          

          <li class="masthead__menu-item">
            <a href="http://get.mocklab.io/?utm_source=wiremock.org&utm_medium=primary-nav&utm_campaign=mocklab" title="MockLab" target="_blank">
              <img src="/wiremock/images/mocklab_logo_transparent.png" style="height: 23px; width: auto; margin-right: 5px; vertical-align: top;" />
              MockLab
            </a>
          </li>
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    

<div id="main" role="main">
  


<div class="sidebar sticky">
  <nav class="nav__list">

    <ul>
      

      
      <li>
        <a href="/wiremock/docs/getting-started/">

        Getting Started
      </a>
      
      <li>
        <a href="/wiremock/docs/junit-rule/">

        The JUnit 4.x Rule
      </a>
      
      <li>
        <a href="/wiremock/docs/java-usage/">

        Java (Non-JUnit) Usage
      </a>
      
      <li>
        <a href="/wiremock/docs/configuration/">

        Configuration
      </a>
      
      <li>
        <a href="/wiremock/docs/running-standalone/">

        Running as a Standalone Process
      </a>
      
      <li>
        <a href="/wiremock/docs/stubbing/">

        Stubbing
      </a>
      
      <li>
        <a href="/docs/verifying/" class="nav__list-item--selected">
        

        Verifying
      </a>
      
      <li>
        <a href="/wiremock/docs/request-matching/">

        Request Matching
      </a>
      
      <li>
        <a href="/wiremock/docs/proxying/">

        Proxying
      </a>
      
      <li>
        <a href="/wiremock/docs/record-playback/">

        Record and Playback (New)
      </a>
      
      <li>
        <a href="/wiremock/docs/response-templating/">

        Response Templating
      </a>
      
      <li>
        <a href="/wiremock/docs/record-playback-legacy/">

        Record and Playback (Legacy)
      </a>
      
      <li>
        <a href="/wiremock/docs/simulating-faults/">

        Simulating Faults
      </a>
      
      <li>
        <a href="/wiremock/docs/stateful-behaviour/">

        Stateful Behaviour
      </a>
      
      <li>
        <a href="/wiremock/docs/https/">

        HTTPS
      </a>
      
      <li>
        <a href="/wiremock/docs/extending-wiremock/">

        Extending WireMock
      </a>
      
      <li>
        <a href="/wiremock/docs/android/">

        Android
      </a>
      
      <li>
        <a href="/wiremock/docs/spring-boot/">

        Spring Boot
      </a>
      
      <li>
        <a href="/wiremock/docs/stub-metadata/">

        Stub Metadata
      </a>
      
      <li>
        <a href="/wiremock/docs/api/">

        Admin API Reference
      </a>
      
    </ul>
  </nav>
</div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Verifying">
    <meta itemprop="description" content="The WireMock server records all requests it receives in memory (atleast until it is reset). This makes it possible to verify thata request matching a specific pattern was received, and also to fetchthe requests’ details.">
    <meta itemprop="datePublished" content="November 29, 2018">
    

    <div class="page__inner-wrap">
      <header>
        <h1 class="page__title" itemprop="headline">Verifying
</h1>
      </header>

      <section class="page__content" itemprop="text">
        <p>The WireMock server records all requests it receives in memory (at
least until it is <a href="/docs/stubbing#reset">reset</a>). This makes it possible to verify that
a request matching a specific pattern was received, and also to fetch
the requests’ details.</p>

<p>Verifying and querying requests relies on the request journal, which is an in-memory log
of received requests. This can be disabled for load testing - see the <a href="/docs/configuration/">Configuration</a> section for details.</p>

<p>Like stubbing, verification also uses WireMock’s <a href="/docs/request-matching/">Request Matching</a> system to filter and query requests.</p>

<h2 id="verification-failures-console-output-and-intellij">Verification failures, console output and IntelliJ</h2>

<p>When verifying via the Java API all failed verifications will result in a <code class="highlighter-rouge">VerificationException</code> being thrown.
<img src="/images/verification-exception.png" alt="Verification exception" /></p>

<p>The message text in the exception is formatted to enable IntelliJ’s failure comparison view:
<img src="/images/idea-comparison-failure.png" alt="Comparison failure" /></p>

<h2 id="verifying-in-java">Verifying in Java</h2>

<p>To verify that a request matching some criteria was received by WireMock
at least once:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">verify</span><span class="o">(</span><span class="n">postRequestedFor</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/verify/this"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="n">equalTo</span><span class="o">(</span><span class="s">"text/xml"</span><span class="o">)));</span>
</code></pre></div></div>

<p>The criteria part in the parameter to <code class="highlighter-rouge">postRequestedFor()</code> uses the same
builder as for stubbing, so all of the same predicates are available.
See <a href="/docs/stubbing/">Stubbing</a> for more details.</p>

<p>To check for a precise number of requests matching the criteria, use
this form:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">verify</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">postRequestedFor</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/three/times"</span><span class="o">)));</span>
</code></pre></div></div>

<p>Or you can use some more advanced comparison operators:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">verify</span><span class="o">(</span><span class="n">lessThan</span><span class="o">(</span><span class="mi">5</span><span class="o">),</span> <span class="n">postRequestedFor</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/many"</span><span class="o">)));</span>
<span class="n">verify</span><span class="o">(</span><span class="n">lessThanOrExactly</span><span class="o">(</span><span class="mi">5</span><span class="o">),</span> <span class="n">postRequestedFor</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/many"</span><span class="o">)));</span>
<span class="n">verify</span><span class="o">(</span><span class="n">exactly</span><span class="o">(</span><span class="mi">5</span><span class="o">),</span> <span class="n">postRequestedFor</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/many"</span><span class="o">)));</span>
<span class="n">verify</span><span class="o">(</span><span class="n">moreThanOrExactly</span><span class="o">(</span><span class="mi">5</span><span class="o">),</span> <span class="n">postRequestedFor</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/many"</span><span class="o">)));</span>
<span class="n">verify</span><span class="o">(</span><span class="n">moreThan</span><span class="o">(</span><span class="mi">5</span><span class="o">),</span> <span class="n">postRequestedFor</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/many"</span><span class="o">)));</span>
</code></pre></div></div>

<h2 id="verifying-via-the-json--http-api">Verifying via the JSON + HTTP API</h2>

<p>There isn’t a direct JSON equivalent to the above Java API. However,
it’s possible to achieve the same effect by requesting a count of the
number of requests matching the specified criteria (and in fact this is
what the Java method does under the hood).</p>

<p>This can be done by posting a JSON document containing the criteria to
<code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/requests/count</code>:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/resource/to/count"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"Content-Type"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"matches"</span><span class="p">:</span><span class="w"> </span><span class="s2">".*/xml"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>A response of this form will be returned:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w"> </span><span class="s2">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="querying-the-request-journal">Querying the request journal</h2>

<h2 id="getting-all-requests">Getting all requests</h2>

<p>All requests received by WireMock since the last reset can be fetched,
along with additional data about whether the request was matched by a stub mapping and the resulting response definition.</p>

<p>In Java:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">List</span><span class="o">&lt;</span><span class="n">ServeEvent</span><span class="o">&gt;</span> <span class="n">allServeEvents</span> <span class="o">=</span> <span class="n">getAllServeEvents</span><span class="o">();</span>
</code></pre></div></div>

<p>And via the HTTP API by sending a <code class="highlighter-rouge">GET</code> to <code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/requests</code>:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"requests"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"95bd9a40-82d4-47ce-9383-25a9e972f05d"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"request"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"/received-request/7"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"absoluteUrl"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:51490/received-request/7"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"method"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"clientIp"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"127.0.0.1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"headers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"Connection"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"keep-alive"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"User-Agent"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Apache-HttpClient/4.5.1 (Java/1.8.0_45)"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Host"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"localhost:51490"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"cookies"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">},</span><span class="w">
      </span><span class="s2">"browserProxyRequest"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"loggedDate"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1475495213275</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bodyAsBase64"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="s2">"body"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="s2">"loggedDateString"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-10-03T11:46:53Z"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"responseDefinition"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"status"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
      </span><span class="s2">"body"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"This was matched"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"wasMatched"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"aa1a4250-f87c-4a17-82e3-79c83441ce03"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"request"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"/received-request/6"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"absoluteUrl"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:51490/received-request/6"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"method"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"clientIp"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"127.0.0.1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"headers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"Connection"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"keep-alive"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"User-Agent"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Apache-HttpClient/4.5.1 (Java/1.8.0_45)"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Host"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"localhost:51490"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"cookies"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">},</span><span class="w">
      </span><span class="s2">"browserProxyRequest"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"loggedDate"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1475495213268</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bodyAsBase64"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="s2">"body"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="s2">"loggedDateString"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-10-03T11:46:53Z"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"responseDefinition"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"status"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transformers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">],</span><span class="w">
      </span><span class="s2">"fromConfiguredStub"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transformerParameters"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"wasMatched"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
  </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"meta"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"total"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"requestJournalDisabled"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Optionally the results can be filtered to those occuring after a specififed (ISO8601) date-time. Also, the result set can optionally be limited in size
e.g. to return the most recent three results after the 7th of June 2016 12pm send:
<code class="highlighter-rouge">GET http://localhost:8080/__admin/requests?since=2016-06-06T12:00:00&amp;limit=3</code></p>

<h3 id="criteria-queries">Criteria queries</h3>

<p>The request journal can also be queried, taking a request pattern as the filter criteria. In Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">List</span><span class="o">&lt;</span><span class="n">LoggedRequest</span><span class="o">&gt;</span> <span class="n">requests</span> <span class="o">=</span> <span class="n">findAll</span><span class="o">(</span><span class="n">putRequestedFor</span><span class="o">(</span><span class="n">urlMatching</span><span class="o">(</span><span class="s">"/api/.*"</span><span class="o">)));</span>
</code></pre></div></div>

<p>And in JSON + HTTP by posting a criteria document (of the same form as
for request counting) to <code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/requests/find</code>,
which will return a response like this:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"requests"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/my/url"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"absoluteUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://mydomain.com/my/url"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"Accept-Language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en-us,en;q=0.5"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"User-Agent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0) Gecko/20100101 Firefox/9.0"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Accept"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/png,image/*;q=0.8,*/*;q=0.5"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="s2">"browserProxyRequest"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"loggedDate"</span><span class="p">:</span><span class="w"> </span><span class="mi">1339083581823</span><span class="p">,</span><span class="w">
      </span><span class="s2">"loggedDateString"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-06-07 16:39:41"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/my/other/url"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"absoluteUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://my.other.domain.com/my/other/url"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"Accept"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text/plain"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Content-Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text/plain"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My text"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"browserProxyRequest"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"loggedDate"</span><span class="p">:</span><span class="w"> </span><span class="mi">1339083581823</span><span class="p">,</span><span class="w">
      </span><span class="s2">"loggedDateString"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-06-07 16:39:41"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="resetting-the-request-journal">Resetting the request journal</h2>

<p>The request log can be reset at any time. If you’re using either of the
JUnit rules this will happen automatically at the start of every test
case. However you can do it yourself via a call to
<code class="highlighter-rouge">WireMock.resetAllRequests()</code> in Java or sending a <code class="highlighter-rouge">DELETE</code> request to <code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/requests</code>.</p>

<h2 id="finding-unmatched-requests">Finding unmatched requests</h2>

<p>To find all requests which were received but not matched by a configured stub (i.e. received the default 404 response) do the following in Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">List</span><span class="o">&lt;</span><span class="n">LoggedRequest</span><span class="o">&gt;</span> <span class="n">unmatched</span> <span class="o">=</span> <span class="n">WireMock</span><span class="o">.</span><span class="na">findUnmatchedRequests</span><span class="o">();</span>
</code></pre></div></div>

<p>To find unmatched requests via the HTTP API, make a <code class="highlighter-rouge">GET</code> request to <code class="highlighter-rouge">/__admin/requests/unmatched</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET http://localhost:8080/__admin/requests/unmatched
<span class="o">{</span>
  <span class="s2">"requests"</span> : <span class="o">[</span> <span class="o">{</span>
    <span class="s2">"url"</span> : <span class="s2">"/nomatch"</span>,
    <span class="s2">"absoluteUrl"</span> : <span class="s2">"http://localhost:8080/nomatch"</span>,
    <span class="s2">"method"</span> : <span class="s2">"GET"</span>,
    <span class="s2">"clientIp"</span> : <span class="s2">"0:0:0:0:0:0:0:1"</span>,
    <span class="s2">"headers"</span> : <span class="o">{</span>
      <span class="s2">"User-Agent"</span> : <span class="s2">"curl/7.30.0"</span>,
      <span class="s2">"Accept"</span> : <span class="s2">"*/*"</span>,
      <span class="s2">"Host"</span> : <span class="s2">"localhost:8080"</span>
    <span class="o">}</span>,
    <span class="s2">"cookies"</span> : <span class="o">{</span> <span class="o">}</span>,
    <span class="s2">"browserProxyRequest"</span> : <span class="nb">false</span>,
    <span class="s2">"loggedDate"</span> : 1467402464520,
    <span class="s2">"bodyAsBase64"</span> : <span class="s2">""</span>,
    <span class="s2">"body"</span> : <span class="s2">""</span>,
    <span class="s2">"loggedDateString"</span> : <span class="s2">"2016-07-01T19:47:44Z"</span>
  <span class="o">}</span> <span class="o">]</span>,
  <span class="s2">"requestJournalDisabled"</span> : <span class="nb">false</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="near-misses">Near misses</h2>

<p>“Near Misses” are enabled by the new “distance” concept added to the matching system.
A near miss is essentially a pairing of a request and request pattern that are not an exact match for each other, that can be ranked by distance.
This is useful when debugging test failures as it is quite common for a request not to be matched to a stub due to a minor difference e.g. a miscapitalised character.</p>

<p>Near misses can either represent the closest stubs to a given request, or the closest requests to a given request pattern depending on the type of query submitted.</p>

<p>To find near misses representing stub mappings closest to the specified request in Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">List</span><span class="o">&lt;</span><span class="n">NearMiss</span><span class="o">&gt;</span> <span class="n">nearMisses</span> <span class="o">=</span> <span class="n">WireMock</span><span class="o">.</span><span class="na">findNearMissesFor</span><span class="o">(</span><span class="n">myLoggedRequest</span><span class="o">);</span>
</code></pre></div></div>

<p>To do the same via the HTTP API:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /__admin/near-misses/request

<span class="o">{</span>
  <span class="s2">"url"</span>: <span class="s2">"/actual"</span>,
  <span class="s2">"absoluteUrl"</span>: <span class="s2">"http://localhost:8080/actual"</span>,
  <span class="s2">"method"</span>: <span class="s2">"GET"</span>,
  <span class="s2">"clientIp"</span>: <span class="s2">"0:0:0:0:0:0:0:1"</span>,
  <span class="s2">"headers"</span>: <span class="o">{</span>
    <span class="s2">"User-Agent"</span>: <span class="s2">"curl/7.30.0"</span>,
    <span class="s2">"Accept"</span>: <span class="s2">"*/*"</span>,
    <span class="s2">"Host"</span>: <span class="s2">"localhost:8080"</span>
  <span class="o">}</span>,
  <span class="s2">"cookies"</span>: <span class="o">{}</span>,
  <span class="s2">"browserProxyRequest"</span>: <span class="nb">false</span>,
  <span class="s2">"loggedDate"</span>: 1467402464520,
  <span class="s2">"bodyAsBase64"</span>: <span class="s2">""</span>,
  <span class="s2">"body"</span>: <span class="s2">""</span>,
  <span class="s2">"loggedDateString"</span>: <span class="s2">"2016-07-01T19:47:44Z"</span>
<span class="o">}</span>
</code></pre></div></div>

<p>will return a response like:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"nearMisses"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/actual"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"absoluteUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8080/nomatch"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"clientIp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:0:0:0:0:0:0:1"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"User-Agent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"curl/7.30.0"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Accept"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*/*"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"localhost:8080"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"cookies"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
        </span><span class="s2">"browserProxyRequest"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"loggedDate"</span><span class="p">:</span><span class="w"> </span><span class="mi">1467402464520</span><span class="p">,</span><span class="w">
        </span><span class="s2">"bodyAsBase64"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"loggedDateString"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-07-01T19:47:44Z"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"stubMapping"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"42aedcf2-1f8d-4009-ac7b-9870e4ab2316"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/expected"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"matchResult"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"distance"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.12962962962962962</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>To find near misses representing stub mappings closest to the specified request in Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">List</span><span class="o">&lt;</span><span class="n">NearMiss</span><span class="o">&gt;</span> <span class="n">nearMisses</span> <span class="o">=</span> <span class="n">WireMock</span><span class="o">.</span><span class="na">findNearMissesFor</span><span class="o">(</span>
    <span class="n">getRequestedFor</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/thing-url"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">containing</span><span class="o">(</span><span class="s">"thing"</span><span class="o">))</span>
<span class="o">);</span>
</code></pre></div></div>

<p>The equivalent via the HTTP API:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /__admin/near-misses/request-pattern

<span class="o">{</span>
    <span class="s2">"url"</span>: <span class="s2">"/almostmatch"</span>,
    <span class="s2">"method"</span>: <span class="s2">"GET"</span>
<span class="o">}</span>
</code></pre></div></div>

<p>will return a response like:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"nearMisses"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/nomatch"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"absoluteUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8080/nomatch"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"clientIp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:0:0:0:0:0:0:1"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"User-Agent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"curl/7.30.0"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Accept"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*/*"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"localhost:8080"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"cookies"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
        </span><span class="s2">"browserProxyRequest"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"loggedDate"</span><span class="p">:</span><span class="w"> </span><span class="mi">1467402464520</span><span class="p">,</span><span class="w">
        </span><span class="s2">"bodyAsBase64"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"loggedDateString"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-07-01T19:47:44Z"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"requestPattern"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/almostmatch"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"matchResult"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"distance"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.06944444444444445</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>As a convenience you can also find the top 3 near misses for every unmatched request:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">List</span><span class="o">&lt;</span><span class="n">NearMiss</span><span class="o">&gt;</span> <span class="n">nearMisses</span> <span class="o">=</span> <span class="n">WireMock</span><span class="o">.</span><span class="na">findNearMissesForAllUnmatched</span><span class="o">();</span>
</code></pre></div></div>

<p>To do the same via the HTTP API, issue a <code class="highlighter-rouge">GET</code> to <code class="highlighter-rouge">/__admin/requests/unmatched/near-misses</code>, which will produce output of the same form as
for the query for near misses by request.</p>

        
      </section>

      <footer class="page__meta">
        
        




      </footer>

      
    </div>

    
  </article>

  
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
    <li><strong>Follow:</strong></li>
    
    
    
    
    
    <li><a href="/wiremock/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2018 Tom Akehurst. Powered by <a href="http://jekyllrb.com"
                                                                                                                                                                  rel="nofollow">Jekyll</a> &amp; <a
  href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.
</div>

<div id="dialog" style="display: none">
  <h2 class="mocklab-popup__title">Looking for super-quick hosted mocks? Try MockLab</h2>
  <p>Instant mock services on your own public URL, zero code required. Paste, record and generate mock data. Tester-friendly UI.</p>
</div>

<script type="text/javascript">
  function setNotificationSeenCookie() {
    var expiresDate = new Date();
    expiresDate.setTime(expiresDate.getTime() + (30 * 86400000));
    document.cookie = "mocklab_notification_seen=true;expires=" + expiresDate.toGMTString() + ";path=/";
  }

  function sendNavigatedToMockLabEvent(location) {
    ga('send', 'event', location, 'navigated_to_mocklab', 'Navigated to MockLab', 1);
  }

  window.onload = function () {
    $("a[title='MockLab']").click(function() {
      ga('send', 'event', 'primary_nav', 'mocklab_clicked', 'MockLab clicked', 1);
      sendNavigatedToMockLabEvent('primary_nav');
    });

    $("a[title='Consulting Services']").click(function() {
      ga('send', 'event', 'primary_nav', 'consulting_services_clicked', 'Consulting Services clicked', 1);
    });

    if (!document.cookie.includes('mocklab_notification_seen') && !window.suppressMockLabPopover) {
      window.setTimeout(function () {
        $("#dialog").dialog({
          dialogClass: 'mocklab-popup',
          draggable: false,
          resizable: false,
          modal: true,
          show: {
            effect: 'fade',
            duration: 1000
          },
          buttons: [{
            class: 'mocklab-popup__confirm-button',
            text: "Learn More",
            click: function () {
              ga('send', 'event', 'mocklab_popup', 'learn_more_clicked', 'Learn More clicked', 1);
              sendNavigatedToMockLabEvent();
              window.location.href = "http://get.mocklab.io/?utm_source=wiremock.org&utm_medium=mocklab-popup&utm_campaign=mocklab"
            }
          }]
        });

        setNotificationSeenCookie();
        ga('send', 'event', 'mocklab_popup', 'mocklab_popup_seen', 'MockLab popup seen', 0);
      }, 500);

    }

    $("#mocklab-callout-learn-more").click(function() {
      ga('send', 'event', 'mocklab_homepage_section', 'learn_more_clicked', 'Learn More clicked', 1);
      sendNavigatedToMockLabEvent('mocklab_homepage_section');
    });

    $("#mocklab-callout-try-it-now").click(function() {
      ga('send', 'event', 'mocklab_homepage_section', 'try_it_now_clicked', 'Try It Now clicked', 2);
      sendNavigatedToMockLabEvent('mocklab_homepage_section');
    });
  };
</script>

      </footer>
    </div>

    <script src="/wiremock/assets/js/main.min.js"></script>




  </body>
</html>

